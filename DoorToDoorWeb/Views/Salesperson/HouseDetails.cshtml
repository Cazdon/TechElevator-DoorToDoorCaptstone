@section Title {House Detail - Salesperson}
@section Scripts {
    @{
        bool isFormOpen = TempData["holdForm"] != null ? (bool)TempData["holdForm"] : false;

        <script>
            const holdForm = @(Json.Serialize(isFormOpen));
            const houseID = @(Model.House.Id);
        </script>
        <script src="~/js/addHouseNote.js"></script>
        <script src="~/js/site.js"></script>
        <script src="~/js/houseStatusChange.js"></script>
    }
}
@model HouseDetailsViewModel
@using DoorToDoorLibrary.DatabaseObjects

<div class="container">
    <h2>House Details:</h2>
    <div class="container">
        <div id="house-details">
            <div id="house-detail-address">
                <h5>Address:</h5>
                <div>@(Model.House.Street)</div>
                <div>@(Model.House.City), @(Model.House.District) @(Model.House.ZipCode)</div>
                <div>@(Model.House.Country)</div>
            </div>
            <div id="house-detail-status">
                <h5>Current Status:</h5>
                <div>
                    <select asp-items="Model.StatusOptions" id="house-status-select"></select>
                    <div id="house-status-update-response"></div>
                </div>
            </div>
            <div id="house-detail-notes">
                <h5>Notes:</h5>
                <div id="show-hide-form" class="show-hide-button">Show Add Note Form</div>
                <form asp-controller="Salesperson" asp-action="AddHouseNote" method="post" id="salesperson-add-note">
                    <input type="hidden" asp-for="AddNote.HouseID" value="@(Model.House.Id)"/>
                    <div class="form-group">
                        <label asp-for="AddNote.Note"></label>
                        <textarea asp-for="AddNote.Note"></textarea>
                        <span asp-validation-for="AddNote.Note"></span>
                    </div>
                    <div class="form-group">
                        <button>Add Note</button>
                        <span>
                            @Html.ValidationMessage("invalid", new { @class = "field-validation-error" })
                        </span>
                    </div>
                </form>
                <ul id="house-notes-list">
                    @foreach (NoteItem note in Model.Notes)
                    {
                        <li class="house-note">
                            <div class="house-note-user-date">@(note.UserName) : @(note.SubmittedDate)</div>
                            <div class="house-note-info">@(note.Note)</div>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>